#!/bin/bash
whois $1 | awk -F': +' 'BEGIN{split("Registrant Admin Tech",s); split("Name Organization Street City State/Province Postal\\ Code Country Phone Phone\\ Ext Fax Fax\\ Ext Email",k); f=1} {k1=$1; sub(/^ +/,"",k1); if(!d[k1]) d[k1]=$2} END{for(i=1;i<=3;i++) for(j=1;j<=12;j++){kn=k[j]; gsub(/\\/,"",kn); fn=s[i]" "kn; l=fn; if(kn~/Ext/) l=l":"; v=d[fn]; if(kn=="Street" && v!="") v=v" "; printf (f?"":"\n") "%s, %s", l, v; f=0}}' > $1.csv
